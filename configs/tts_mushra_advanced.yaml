#
# Advanced MUSHRA Configuration for TTS Evaluation
#
testname: Advanced TTS MUSHRA Evaluation
testId: tts_mushra_advanced
bufferSize: 4096 # Increased buffer size for potentially larger audio files
stopOnErrors: true
showButtonPreviousPage: true
remoteService: service/write.php # Enable this and 'writeResults: true' on the finish page to save data

pages:
    # --- 1. Welcome Page ---
    - type: generic
      id: welcome
      name: Welcome to the Listening Test
      content: |
        <p>Welcome!</p>
        <p>In this experiment, you will evaluate the quality of several audio samples generated by Text-to-Speech (TTS) systems.</p>
        <p>Please use high-quality headphones and ensure you are in a quiet environment.</p>

    # --- 2. Consent Form ---
    - type: consent
      id: consent_page
      name: Consent Form
      mustConsent: true # User must agree to continue
      content: |
        <p>You are about to participate in a listening test for research purposes.</p>
        <p>Your anonymous responses will be collected and used for the evaluation of audio quality. No personal data will be stored.</p>
        <p>By clicking "I agree", you confirm that you have read and understood this information and consent to participate.</p>

    # --- 3. Volume Adjustment Page ---
    - type: volume
      id: volume_adjustment
      name: Volume Settings
      content: |
        <p>Before we begin, please adjust the volume of your playback device to a comfortable level.</p>
        <p>Play the audio sample below and set the volume slider. This setting will be used for the rest of the test.</p>
      stimulus: configs/resources/audio/mono_ref.wav # Using a standard file for volume setting
      defaultVolume: 0.5

    # --- 4. Training Section ---
    - type: generic
      id: training_info
      name: Training Session
      content: |
        <p>The next page is a training trial to familiarize you with the test interface.</p>
        <p>You will see a "Reference" button and several other buttons for the samples you need to rate ("A", "B", "C", etc.).</p>
        <p>Your task is to rate the quality of each sample in relation to the hidden Reference. A score of 100 means a sample is identical to the reference, while a lower score indicates a perceived degradation in quality.</p>

    - type: mushra
      id: training_trial
      name: Training MUSHRA
      content: This is a training trial. The names of the conditions (including the Reference) are visible.
      showWaveform: true
      enableLooping: true
      # For training, we show the condition names and don't randomize them
      randomize: false
      showConditionNames: true
      reference: configs/resources/audio/mono_ref.wav
      createAnchor35: true # Automatically create a low-quality anchor for training
      stimuli:
          Condition_1: configs/resources/audio/mono_c1.wav
          Condition_2: configs/resources/audio/mono_c2.wav

    # --- 5. Start of the Actual Test ---
    - type: generic
      id: test_start_info
      name: The test is about to begin
      content: <p>The training is now complete. The actual test will now begin. Good luck!</p>

    # --- 6. TTS MUSHRA Trials ---
    # You can copy and paste this block for each sentence/sample you want to test.
    - type: mushra
      id: tts_trial_1_sentence_A
      name: Evaluation - Sample 1
      content: Please rate the audio quality of the samples.
      showWaveform: true
      enableLooping: true
      reference: configs/resources/audio/hidden_original/PF_0_emo.wav
      stimuli:
          OurModel: configs/resources/audio/anchor/PF_0_emo_anchor.wav
          OtherModel: configs/resources/audio/anchor/PF_0_emo_anchor.wav
          Anchor: configs/resources/audio/anchor/PF_0_emo_anchor.wav

    - type: mushra
      id: tts_trial_2_sentence_B
      name: Evaluation - Sample 2
      content: Please rate the audio quality of the samples.
      showWaveform: true
      enableLooping: true
      reference: configs/resources/audio/mono_ref.wav
      stimuli:
          OurModel: configs/resources/audio/mono_c1.wav
          OtherModel: configs/resources/audio/mono_c2.wav
          Anchor: configs/resources/audio/mono_c3.wav

    # --- 7. Finish Page with Questionnaire ---
    - type: finish
      id: finish
      name: Thank You!
      content: Thank you for participating in this listening test!
      showResults: false # Hides the detailed results from the participant
      writeResults: true
      questionnaire:
          - type: number
            label: Please enter your age
            name: age
            optional: true
            min: 1
            max: 100
          - type: long_text
            label: Do you have any other feedback for us?
            name: feedback
            optional: true
